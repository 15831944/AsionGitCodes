<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- 這篇文章由Dancingwind翻譯，作者的聯繫方式zhouwei02@mails.tsinghua.edu.cn -->
<HTML>
<!-- Mirrored from www.alucardma.com/dancingwind/OpenGL/Nehe/Course/Tutorial_48.htm by HTTrack Website Copier/3.x [XR&CO'2006], Sat, 25 Nov 2006 10:05:22 GMT -->
<HEAD><TITLE>NeHe OpenGL教程第四十八課，DancingWind翻譯</TITLE>
<meta http-equiv="Content-Type" content="text/html; charset=big5">
<style type=text/css>
A:active {
	BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: #bbccff; TEXT-DECORATION: none
}
A:link {
	BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: #bbccff; TEXT-DECORATION: none
}
A:visited {
	BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: #bbccff; TEXT-DECORATION: none
}
A:hover {
	BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: #ffda6a; TEXT-DECORATION: none
}
BODY {
	COLOR: #ffffff; BACKGROUND-COLOR: #000000
}
TD IMG {
	DISPLAY: block
}
.back {
	BACKGROUND: #000022; COLOR: #ffffff
}
.back2 {
	BACKGROUND: #000000; COLOR: #ffffff
}
.back3 {
	BACKGROUND: #000022; COLOR: #ffffff
}
.copy {
	FONT-SIZE: 11px; LINE-HEIGHT: normal; FONT-STYLE: normal; FONT-FAMILY: Tahoma, Verdana, sans-serif; FONT-VARIANT: normal; TEXT-DECORATION: none
}
.head {
	FONT: bold 13px Tahoma, Verdana, sans-serif; TEXT-DECORATION: none
}
.link {
	FONT-SIZE: 14px; LINE-HEIGHT: normal; FONT-STYLE: normal; FONT-FAMILY: Tahoma, Verdana, sans-serif; FONT-VARIANT: normal; TEXT-DECORATION: none
}
.menu {
	FONT: bold 17px Tahoma, Verdana, sans-serif; TEXT-DECORATION: none
}
.news {
	BACKGROUND: #00008b; COLOR: #ffffff
}
.tab {
	PADDING-LEFT: 35px
}
.text {
	FONT-SIZE: 12px; LINE-HEIGHT: normal; FONT-STYLE: normal; FONT-FAMILY: Tahoma, Verdana, sans-serif; FONT-VARIANT: normal; TEXT-DECORATION: none
}
.theme {
	BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: #bbccff
}
.dotted {
	BORDER-RIGHT: #00008b 2px dotted; BORDER-TOP: #00008b 2px dotted; BORDER-LEFT: #00008b 2px dotted; BORDER-BOTTOM: #00008b 2px dotted
}
.solid {
	BORDER-RIGHT: #ffffff 1px solid; BORDER-TOP: #ffffff 1px solid; BORDER-LEFT: #ffffff 1px solid; BORDER-BOTTOM: #ffffff 1px solid
}
.logo {
	BACKGROUND-IMAGE: url(../graphics/rgb/logo.html)
}
.menubar {
	BACKGROUND-IMAGE: url(../graphics/rgb/menubar.html)
}
.menubg {
	BACKGROUND-IMAGE: url(../graphics/rgb/menubg.html)
}
.menuheading {
	BACKGROUND-IMAGE: url(../graphics/rgb/menuheading.html)
}
.nehebutton {
	BACKGROUND-IMAGE: url(../graphics/rgb/nehebutton.html)
}
.newslogo {
	BACKGROUND-IMAGE: url(../graphics/rgb/newslogo.html)
}
.tinylogo {
	BACKGROUND-IMAGE: url(../graphics/rgb/border/tinylogo.html)
}
.bc {
	BACKGROUND-IMAGE:  url(../Pic/bc.png)
}
.bl {
	BACKGROUND-IMAGE:  url(../Pic/bl.png)
}
.br {
	BACKGROUND-IMAGE:  url(../Pic/br.png)
}
.c {
	BACKGROUND-IMAGE: url(../Picc.html)
}
.l {
	BACKGROUND-IMAGE:  url(../Pic/l.png)
}
.lc {
	BACKGROUND-IMAGE: url(../Piclc.html)
}
.r {
	BACKGROUND-IMAGE:  url(../Pic/r.png)
}
.rc {
	BACKGROUND-IMAGE: url(../Picrc.html)
}
.tc {
	BACKGROUND-IMAGE:  url(../Pic/tc.png)
}
.tl {
	BACKGROUND-IMAGE:  url(../Pic/tl.png)
}
.tr {
	BACKGROUND-IMAGE:  url(../Pic/tr.png)
}

</style>
</head>
<BODY text=white vLink=#aaccff link=#aaccff bgColor=black>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=tinylogo width=326 height=130><IMG height=130 
      alt="NeHe Productions" 
      src="../Pic/logo.png" width=326></TD>
      <TD vAlign=center align=middle><div align="center"><FONT class=text><FONT class=theme 
      size=+3><B><I>第48課</I></B></FONT></FONT></div></TD>
  </TR></TBODY></TABLE>
  <!-- 上邊框-->
<table border="0" cellPadding="0" cellSpacing="0" width="100%">
<TBODY>
  <tr>
    <td><img height="28" src="../Pic/tl.jpg" width="28"></td>
    <td width="100%"><img height="28" src="../Pic/tc.gif" width="100%"></td>
    <td><img height="28" src="../Pic/tr.gif" width="28"></td>
  </tr>
</TBODY>
</table>

<!-- 中部-->
<table border="0" cellPadding="0" cellSpacing="0" width="100%">
<TBODY>
  <tr>
  	<!-- 中部左邊框-->
    <td  background="../Pic/l.gif"><img src="../Pic/l.gif" width="28" height="28"></td>
	<!-- 中部文字部分-->
    <td vAlign="top" width="100%">
	<table width="100%" border="0">
          <tr>
            <td width="18%"><img src="../Pic/lesson48.jpg" width="160" height="120"></td>
            <td width="82%"><p><font ><b>軌跡球實現的鼠標旋轉</b></font></p>
              <p><font size="3">使用鼠標旋轉物體,很簡單也有很多實現方法,這裡我們教會你模擬軌跡球來實現它.</font></p></td>
          </tr>
     </table>
      </td>
	<!-- 中部右邊框-->
    <td background="../Pic/r.gif"><img src="../Pic/r.gif" width="28" height="28"></td>
  </tr>
</TBODY>
</table>

<!-- 下邊框-->
<table border="0" cellPadding="0" cellSpacing="0" width="100%">
<TBODY>
  <tr>
    <td><img height="28" src="../Pic/bl.gif" width="28"></td>
    <td width="100%"><img height="28" src="../Pic/bc.gif" width="100%"></td>
    <td><img height="28" src="../Pic/br.gif" width="28"></td>
  </tr>
</TBODY>
</table>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=tl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=tc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
    width="100%"></TD>
    <TD class=tr><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=l><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
      <TD class=back3 vAlign=top width="100%">軌跡球控制<br>
        By Terence J. Grant (tjgrant@tatewake.com) 
        <p>如果只用鼠標來控制你的模型是不是很酷?軌跡球可以幫你做到這一點，我將告訴你我的實現，你可以把它應用在你的工程裡。</p>
        <p>我的實現是基於Bretton Wade』s，它是基於Ken Shoemake』s 實現的，最初的版本，你可以從遊戲編程指南這本圖上找到。但我還是修正了一些錯誤，並優化了它。</p>
        <p>軌跡球實現的內容就是把二維的鼠標點映射到三維的軌跡球，並基於它完成旋轉變化。</p>
        <p>為了完成這個設想，首先我們把鼠標坐標映射到[-1，1]之間，它很簡單：<br>
        </p>
        <p>&nbsp;</p>
    </TD>
    <TD class=r><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=bl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=bc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=br><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<PRE>MousePt.X  =  ((MousePt.X / ((Width  -1) / 2)) -1);<br>MousePt.Y  = -((MousePt.Y / ((Height -1) / 2))-1);</PRE>
<p></p>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=tl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=tc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
    width="100%"></TD>
    <TD class=tr><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=l><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
      <TD class=back3 vAlign=top width="100%">這只是為了數學上的簡化，下面我們計算這個長度，如果它大於軌跡球的邊界，我們將簡單的把z軸設為0，否則我們把z軸設置為這個二維點映射到球面上對應的z值。
        <p>一旦我們有了兩個點，就可以計算它的法向量了和旋轉角了。</p>
        <p>下面我們從構造函數開始，完整的講解這個類：</p>
        <p>&nbsp;</p>
    </TD>
    <TD class=r><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=bl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=bc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=br><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<PRE>ArcBall_t::ArcBall_t(GLfloat NewWidth, GLfloat NewHeight)</PRE>
<p></p>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=tl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=tc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
    width="100%"></TD>
    <TD class=tr><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=l><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
      <TD class=back3 vAlign=top width="100%">當點擊鼠標時，記錄點擊的位置 </TD>
    <TD class=r><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=bl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=bc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=br><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<PRE>void    ArcBall_t::click(const Point2fT* NewPt)</PRE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=tl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=tc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
    width="100%"></TD>
    <TD class=tr><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=l><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
      <TD class=back3 vAlign=top width="100%">當拖動鼠標時，記錄當前鼠標的位置，並計算出旋轉的量。 </TD>
    <TD class=r><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=bl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=bc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=br><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<p>void ArcBall_t::drag(const Point2fT* NewPt, Quat4fT* NewRot)<br>
</p>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=tl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=tc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
    width="100%"></TD>
    <TD class=tr><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=l><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
      <TD class=back3 vAlign=top width="100%">如果窗口大小改變，設置鼠標移動的範圍</TD>
    <TD class=r><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=bl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=bc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=br><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<PRE>void    ArcBall_t::setBounds(GLfloat NewWidth, GLfloat NewHeight)</PRE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=tl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=tc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
    width="100%"></TD>
    <TD class=tr><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=l><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
      <TD class=back3 vAlign=top width="100%">下面是完成計算所要用到的數據結果，都是一些矩陣和向量</TD>
    <TD class=r><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=bl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=bc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=br><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<PRE><br>Matrix4fT	Transform = {  1.0f,  0.0f,  0.0f,  0.0f,<br>			       0.0f,  1.0f,  0.0f,  0.0f,<br>			       0.0f,  0.0f,  1.0f,  0.0f,<br>			       0.0f,  0.0f,  0.0f,  1.0f };</PRE>
<p>Matrix3fT LastRot = { 1.0f, 0.0f, 0.0f, <br>
  0.0f, 1.0f, 0.0f,<br>
  0.0f, 0.0f, 1.0f };</p>
<p>Matrix3fT ThisRot = { 1.0f, 0.0f, 0.0f, <br>
  0.0f, 1.0f, 0.0f,<br>
  0.0f, 0.0f, 1.0f };</p>
<p>ArcBallT ArcBall(640.0f, 480.0f); <br>
  Point2fT MousePt; <br>
  bool isClicked = false; <span class="theme">// 是否點擊鼠標</span><br>
  bool isRClicked = false; <span class="theme">// 是否右擊鼠標</span><br>
  bool isDragging = false; <span class="theme">// 是否拖動</span></p>
<p></p>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=tl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=tc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
    width="100%"></TD>
    <TD class=tr><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=l><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
      <TD class=back3 vAlign=top width="100%">在上面定義的變量中，transform是我們獲得的最終的變換矩陣，lastRot是上一次鼠標拖動得到的旋轉矩陣，thisRot為這次鼠標拖動得到的旋轉矩陣。
        <p>當我們點擊鼠標時，創建一個單位旋轉矩陣，當我們拖動鼠標時，這個矩陣跟蹤鼠標的變化。</p>
        <p>為了更新鼠標的移動範圍，我們在函數ReshapeGL中加入下面一行：</p>
        <p>&nbsp;</p>
    </TD>
    <TD class=r><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=bl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=bc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=br><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<PRE>void ReshapeGL (int width, int height)<br>{<br>	. . .<br>	ArcBall.setBounds((GLfloat)width, (GLfloat)height);			<span class="theme">	// 更新鼠標的移動範圍</span><br>}</PRE>
<p><span class="theme">// 處理鼠標的按鍵操作</span><br>
  LRESULT CALLBACK WindowProc (HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM lParam)<br>
  {<br>
  . . .<br>
  case WM_MOUSEMOVE:<br>
  MousePt.s.X = (GLfloat)LOWORD(lParam);<br>
  MousePt.s.Y = (GLfloat)HIWORD(lParam);<br>
  isClicked = (LOWORD(wParam) &amp; MK_LBUTTON) ? true : false;<br>
  isRClicked = (LOWORD(wParam) &amp; MK_RBUTTON) ? true : false;<br>
  break;</p>
<p> case WM_LBUTTONUP: isClicked = false; break;<br>
  case WM_RBUTTONUP: isRClicked = false; break;<br>
  case WM_LBUTTONDOWN: isClicked = true; break;<br>
  case WM_RBUTTONDOWN: isRClicked = true; break;<br>
  . . .<br>
  }</p>
<p></p>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=tl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=tc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
    width="100%"></TD>
    <TD class=tr><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=l><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
      <TD class=back3 vAlign=top width="100%">為了隨著輸入更新我們的的狀態，在Update函數中需要處理更新參數</TD>
    <TD class=r><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=bl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=bc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=br><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<PRE>if (isRClicked)										<span class="theme">// 如果右鍵按下，這重置所有的變量</span><br>{<br>	Matrix3fSetIdentity(&amp;LastRot);
  Matrix3fSetIdentity(&amp;ThisRot);
  Matrix4fSetRotationFromMatrix3f(&amp;Transform, &amp;ThisRot);
  }</PRE>
<p>if (!isDragging) <span class="theme">// 如果沒有拖動</span><br>
  {<br>
  if (isClicked) <span class="theme">// 第一次按下</span><br>
  {<br>
  isDragging = true; <span class="theme">// 設置拖動為變量為true</span><br>
  LastRot = ThisRot; <br>
  ArcBall.click(&amp;MousePt); <br>
  }<br>
  }<br>
  else<br>
  {<br>
  if (isClicked) <span class="theme">//如果按住拖動</span><br>
  {<br>
  Quat4fT ThisQuat;</p>
<p> ArcBall.drag(&amp;MousePt, &amp;ThisQuat); <span class="theme">// 更新軌跡球的變量</span><br>
  Matrix3fSetRotationFromQuat4f(&amp;ThisRot, &amp;ThisQuat); <span class="theme">// 
  計算旋轉量</span><br>
  Matrix3fMulMatrix3f(&amp;ThisRot, &amp;LastRot); <br>
  Matrix4fSetRotationFromMatrix3f(&amp;Transform, &amp;ThisRot); <br>
  }<br>
  else<span class="theme"> // 如果放開鼠標，設置拖動為false</span><br>
  isDragging = false;<br>
  }</p>
<p></p>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=tl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=tc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
    width="100%"></TD>
    <TD class=tr><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=l><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
      <TD class=back3 vAlign=top width="100%">好了，完成了上面的內容。我們到了繪製的階段。<br>
        記住在繪製前，把我們得到的矩陣乘以當前的模型變換矩陣。</TD>
    <TD class=r><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=bl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=bc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=br><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<PRE>glPushMatrix();									<span class="theme">// 保存當前的矩陣</span><br>	glMultMatrixf(Transform.M);							<span class="theme">// 應用我們的變換矩陣</span></PRE>
<p> glBegin(GL_TRIANGLES); <span class="theme">// 繪製模型</span><br>
  . . .<br>
  glEnd(); </p>
<p> glPopMatrix(); <span class="theme">// 彈出保存的矩陣</span></p>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=tl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=tc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
    width="100%"></TD>
    <TD class=tr><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=l><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
      <TD class=back3 vAlign=top width="100%"><p>我已經在上面給掩飾了所有的技巧，你可以不使用我告訴你的數學技巧，因為我想你會有更好的。現在你已經看到了，這是多麼的簡單，你完全可以按你的風格創造出更好的軌跡球。</p>
<table width="100%" border="1">
  <tr>
    <td width="27%"><img src="../images/logo%203.jpg" width="209" height="200" align="middle"></td>
    <td width="73%">版權與使用聲明:<br>
      我是個對學習和生活充滿激情的普通男孩,在網絡上我以DancingWind為暱稱，我的聯繫方式是zhouwei02@mails.tsinghua.edu.cn，如果你有任何問題，都可以聯繫我。
      <p>引子<br>
        網絡是一個共享的資源，但我在自己的學習生涯中浪費大量的時間去搜索可用的資料，在現實生活中花費了大量的金錢和時間在書店中尋找資料，於是我給自己起了個暱稱DancingWind，其意義是想風一樣從各個知識的站點中吸取成長的養料。在飄蕩了多年之後，我決定把自己收集的資料整理為一個統一的資源庫。</p>
      <p>版權聲明<br>
        所有DancingWind發表的內容，大多都來自共享的資源，所以我沒有資格把它們據為己有，或聲稱自己為這些資源作出了一點貢獻。故任何人都可以複製，修改，重新發表，甚至以自己的名義發表，我都不會追究，但你在做以上事情的時候必須保證內容的完整性，給後來的人一個完整的教程。最後，任何人不能以這些資料的任何部分，謀取任何形式的報酬。</p>
      <p>發展計劃<br>
        在國外，很多資料都是很多人花費幾年的時間慢慢積累起來的。如果任何人有興趣與別人共享你的知識，我很歡迎你與我聯繫，但你必須同意我上面的聲明。</p>
              <p>感謝<br>
                感謝我的母親一直以來對我的支持和在生活上的照顧。<br>
                感謝我深愛的女友田芹，一直以來默默的在精神上和生活中對我的支持，她甚至把買衣服的錢都用來給我買書了，她真的是我見過的最好的女孩，希望我能帶給她幸福。</p>
              <p>資源下載: <br>
                文檔 <a href="http://www.alucardma.com/dancingwind/OpenGL/Nehe/Res/mht/NeHe%20OpenGL%20Chinese%20Course%2048.mht">網頁格式</a> 
                <a href="http://www.alucardma.com/dancingwind/OpenGL/Nehe/Res/pdf/OpenGL_Nehe_Course_Tutorial_48.pdf">PDF格式</a><br>
                源碼 <a href="http://www.alucardma.com/dancingwind/OpenGL/Nehe/Res/Src/48_ArcBall.rar">RAR格式</a></p></td>
  </tr>
</table>
        <FONT class=text><TABLE width="100%" border=0>
          <TBODY>
            <TR> 
              <TD align=left width="50%"><B><FONT size=-1><A 
            href="Tutorial_47.html">&lt; 第47課</A></FONT></B></TD>
              <TD align=right width="50%"></TD>
            </TR>
          </TBODY>
        </TABLE>
        </FONT> 		
    </TD>
    <TD class=r><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=bl><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=bc width="100%"><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" width=28></TD>
    <TD class=br><IMG height=28 alt="" 
      src="../Pic/blank(1).gif" 
  width=28></TD></TR></TBODY></TABLE>
</BODY>
<!-- Mirrored from www.alucardma.com/dancingwind/OpenGL/Nehe/Course/Tutorial_48.htm by HTTrack Website Copier/3.x [XR&CO'2006], Sat, 25 Nov 2006 10:05:22 GMT -->
</HTML>
